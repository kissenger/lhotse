<div class="dynamic-container">
  <h2>Shop</h2> 
  Select your items below, click to pay, and we'll pop it in the post.  It's as simple as that!
  <div class="basket">
    @for (basketItem of shop.basket.items; track $index) {
      <div class="basket-item">

        <img
          [src] = "basketItem.image.src"
          [alt] = "basketItem.image.alt"
        />         

        <div class="text"> {{basketItem.description}} </div>
        
        <div class="qty">
          <button class="plus-minus" (click)="onPlusMinus(basketItem.id,-1)" [disabled]="shop.orderStatus!='draft'">-</button>
          <input id="qty{{$index}}" class="qty" type="number" min=0 name="qty-input-{{$index}}" [disabled]="shop.orderStatus!='draft'"  [(ngModel)]="basketItem.quantity" readonly> 
          <button class="plus-minus" (click)="onPlusMinus(basketItem.id,1)" [disabled]="shop.orderStatus!='draft'">+</button>
        </div>
  
        <div class="value">{{basketItem.quantity * basketItem.unit_amount.value | currency: 'GBP' : 'symbol' : '1.2-2' : 'en' }}</div>
      </div>
    }

    <!-- solution for animating height: https://keithjgrant.com/posts/2023/04/transitioning-to-height-auto/ -->
    <div class="hidden-basket-item-wrapper" [ngClass]="shop.basket.discountPercent ? 'show' : ''">
      <div class="hidden-basket-item">
        <div class="basket-item">
          <div class="text indented">{{shop.basket.discountPercent}}% Discount</div>
          <div class="value-wide">{{shop.basket.discountValue  | currency: 'GBP' : 'symbol' : '1.2-2' : 'en' }}</div>
        </div> 
      </div> 
    </div>
  
    <div class="basket-item">
        <div class="text indented">Shipping ({{shop.basket.selectedShippingLabel}})</div>
        <div class="value-wide">{{shop.basket.shippingCost | currency: 'GBP' : 'symbol' : '1.2-2' : 'en' }}</div>
      <!-- <div class="basket-item-note">
        Shipping options can be changed in PayPal checkout<br>
        If you wish to select pickup, please contact us in advance
      </div> -->
    </div>      
  
    <div class="basket-item last-row">
      <div class="text indented">Total</div>
      <div class="value-wide">{{shop.basket.totalCost | currency: 'GBP' : 'symbol' : '1.2-2' : 'en' }}</div>
    </div>
    
    <!-- <div class="basket-item">
      <div class="text indented">Discount&nbsp;Code:</div>
      <div class="value-wide"> -->
        <!-- <label class="discount-label" for="discount">Discount&nbsp;Code:</label> -->
        <!-- <input class="discount" type="text" id="discount" name="discount" (keyup)="onCodeChange()" [disabled]="shop.orderStatus!='draft'" [(ngModel)]="shop.basket.discountCode">
      </div> -->

      <!-- <div class="basket-item-note basket-item-note-right">
        @if (dirtyDiscountCode) {
          @if (shop.basket.discountPercent === 0) {
            Entered code is not valid
          } @else {
            Discount applied!
          }  
        }
      </div> -->
    <!-- </div> -->

    @if (shop.orderStatus === "draft") {

      <!-- <div class="basket-item">
        <div class="text indented">Discount&nbsp;Code</div>
        <div class="value-wide">
          <input class="discount" type="text" id="discount" name="discount" (keyup)="onCodeChange()" [disabled]="shop.orderStatus!='draft'" [(ngModel)]="shop.basket.discountCode">
        </div>
      </div> -->

      <div class="below-basket-container">
        <div class="discount-code">
          <input class="discount" type="text" placeholder="Discount Code" id="discount" name="discount" (keyup)="onCodeChange()" [disabled]="shop.orderStatus!='draft'" [(ngModel)]="shop.basket.discountCode">
          <div id="paypal-button-container"></div>

        </div>
      </div>
    } @else {
      <app-order-outcome></app-order-outcome>
    }
  </div>



</div>
    



