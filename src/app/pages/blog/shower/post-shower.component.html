
<!-- this is needed to avoid error where intro is not rendered  -->
@defer (when isReadyToLoad) {
    <div class="article-image-container">
        <img
            [ngSrc]="post.imgFname"
            [alt]="post.imgAlt"
            priority
            fill /> 
        <div class="title-image-caption"> 
            <h1>{{post.title}}</h1>
            <div class="below-title-text">
                <span>Published {{post.timeStamp | date : 'MMM YYYY'}}</span> <br />
                <div>
                @for (kw of post.keywords; track kw) {
                    <span class="kw">{{kw}}</span>
                }
                </div>
            </div>
        </div>
    </div>

    <div class="dynamic-container">

        <div class="intro" [innerHTML]="post.intro | sanitizer"></div>

        <section class="anchor" id="contents">
            <h4>Contents</h4>
            <ul>
                @for(section of post.sections; track section) {
                    <li>
                        <a [routerLink]="'.'" [fragment]="section.title | kebaber">{{section.title}}</a>
                    </li>
                } 
            </ul>
        </section>
        <br />

        <app-banner-ad></app-banner-ad>
        
        @for (section of post.sections; track section) {
            <a class="anchor" id="{{section.title | kebaber}}"></a>
            <h4>{{section.title}}</h4>
            <div [innerHTML]="section.content | sanitizer"></div>
            @if (!!section.imgFname) {
                <div class="article-image-container">
                    <img
                        [ngSrc]="section.imgFname"
                        [alt]="section.imgAlt"
                        fill
                    /> 
                    <div class="image-caption">
                        {{section.imgAlt}} <br />
                        Photo credit: Snorkelology
                    </div>
                </div>
            }
            <a [routerLink]="'.'" [fragment]="'contents'">Back to contents</a>
        }

        <app-banner-ad></app-banner-ad>
        <h4>Conclusion</h4>
        <div [innerHTML]="post.conclusion | sanitizer"></div>

    </div>
}